# Blurry Loading

æ­¤ç¬”è®°æ˜¯æˆ‘å†™é™æ€é¡µé¢demoç»ƒæ‰‹çš„è®°å½•ï¼ŒğŸ‘‡ä¸ºè¯¥demoçš„åŸå€ï¼šhttps://github.com/bradtraversy/50projects50days/tree/master/blurry-loading

å‘å‡ºæ¥çš„ç›®çš„æ˜¯ä¸ºäº†å¦‚æœå¯¹ä½ æœ‰ä¸€ç‚¹ç‚¹å¸®åŠ©å°±å¤Ÿäº†ã€‚

## çŸ¥è¯†ç‚¹

- ##### `background`
  
    è¿™æ˜¯ä¸€ä¸ªç®€å†™å±æ€§ï¼Œå¯ä»¥ä¸€æ¬¡åŒæ—¶å£°æ˜å¤šä¸ªå±æ€§ï¼š
    
    - `background-clip`
      
        è®¾ç½®å…ƒç´ çš„èƒŒæ™¯å›¾ç‰‡æˆ–è€…èƒŒæ™¯é¢œè‰²æ˜¯å¦çœ¼ç¥åˆ°è¾¹æ¡†borderï¼Œpaddingï¼Œå†…å®¹ç›’å­ã€‚
        
        [background-clip - CSSï¼ˆå±‚å æ ·å¼è¡¨ï¼‰ | MDN](https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-clip)
        
    - `background-color`
      
        ç”¨äºè®¾ç½®å…ƒç´ çš„èƒŒæ™¯è‰²ï¼Œåªèƒ½æ˜¯é¢œè‰²å€¼æˆ–è€…transparentä¸­äºŒè€…é€‰ä¸€ã€‚
        
        å½“ç„¶é¢œè‰²å€¼çš„ä¸€äº›ç‰¹æ®Šå½¢å¼è¦çŸ¥é“ï¼š
        
        - inherit ç»§æ‰¿é¢œè‰²
        - currentColor å½“å‰é¢œè‰²
        
    - `background-image`
      
        ç”¨äºè®¾ç½®ä¸€ä¸ªæˆ–è€…å¤šä¸ªèƒŒæ™¯å›¾
        
        [https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-image](https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-image)
        
        å¤šä¸ªå›¾åƒèƒŒæ™¯æ—¶ï¼Œç¬¬ä¸€ä¸ªè®¾ç½®çš„ä¼šåœ¨æœ€ä¸Šé¢ï¼Œæœ€æ¥è¿‘ç”¨æˆ·ã€‚
        
        ```css
        background-image:
          linear-gradient(to bottom, rgba(255,255,0,0.5), rgba(0,0,255,0.5)),
          url('https://mdn.mozillademos.org/files/7693/catfront.png');
        ```
        
    - `background-origin`
      
        ç”¨äºæŒ‡å®šèƒŒæ™¯å›¾ç‰‡çš„åŸç‚¹ä½ç½®çš„ç›¸å¯¹åŒºåŸŸã€‚
        
        - border-box  èƒŒæ™¯å›¾åƒçš„æ‘†æ”¾ä»¥borderåŒºåŸŸä¸ºå‚è€ƒ
        - padding-box  ä»¥paddingä¸ºå‚è€ƒ
        - content-box   ä»¥contentä¸ºå‚è€ƒ
    - `background-position`
      
        ç”¨äºè®¾ç½®èƒŒæ™¯å›¾çš„åˆå§‹ä½ç½®ã€‚è¿™ä¸ªä½ç½®ç›¸å¯¹äºbackground-originå®šä¹‰çš„ä½ç½®å›¾å±‚ã€‚
        
        å…³é”®å­—centerï¼Œç”¨æ¥å±…ä¸­æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡ã€‚æœ¬demoå°±ç”¨åˆ°è¿™ä¸ªå±æ€§ã€‚
        
        ```css
        background-position: center;
        ```
        
        [https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-position](https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-position)
        
    - `background-repeat`
      
        ç”¨æ¥æŒ‡å®šèƒŒæ™¯å›¾åƒçš„é‡å¤æ–¹å¼
        
        [https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-repeat](https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-repeat)
        
    - `background-size`
      
        [https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-size](https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-size)
        
        - `cover`
        Â å€¼å°½å¯èƒ½å¤§çš„ç¼©æ”¾èƒŒæ™¯å›¾åƒå¹¶ä¿æŒå›¾åƒçš„å®½é«˜æ¯”ä¾‹ï¼ˆå›¾åƒä¸ä¼šè¢«å‹æ‰ï¼‰ã€‚è¯¥èƒŒæ™¯å›¾ä»¥å®ƒçš„å…¨éƒ¨å®½æˆ–è€…é«˜è¦†ç›–æ‰€åœ¨å®¹å™¨ã€‚å½“å®¹å™¨å’ŒèƒŒæ™¯å›¾å¤§å°ä¸åŒæ—¶ï¼ŒèƒŒæ™¯å›¾çš„ å·¦ / å³ æˆ–è€… ä¸Š / ä¸‹ éƒ¨åˆ†ä¼šè¢«è£å‰ªã€‚
        - **`contain`**
          
            ç¼©æ”¾èƒŒæ™¯å›¾ç‰‡ä»¥å®Œå…¨è£…å…¥èƒŒæ™¯åŒºï¼Œå¯èƒ½èƒŒæ™¯åŒºéƒ¨åˆ†ç©ºç™½ã€‚`contain`Â å°½å¯èƒ½çš„ç¼©æ”¾èƒŒæ™¯å¹¶ä¿æŒå›¾åƒçš„å®½é«˜æ¯”ä¾‹ï¼ˆå›¾åƒä¸ä¼šè¢«å‹ç¼©ï¼‰ã€‚
        
    - `background-attachment`
      
        å†³å®šèƒŒæ™¯å›¾åƒçš„ä½ç½®æ˜¯åœ¨è§†å£å†…å›ºå®šï¼Œæˆ–è€…éšç€åŒ…å«å®ƒçš„åŒºå—æ»šåŠ¨ã€‚
    
- ##### **innerHTMLã€innerTextã€outerHTMLã€textContentã€nodeValueã€data**
    
    1. **innerHTMLã€outerHTML  åªå¯¹å…ƒç´ èŠ‚ç‚¹æœ‰æ•ˆ**
        
        1. innerHTMLï¼šè®¾ç½®æˆ–è·å–å½“å‰å…ƒç´ ä¸‹çš„HTMLã€‚
        
        ```jsx
        console.log(document.body.innerHTML);
        ```
        
        ```html
        <div class="bg"></div>
        <div class="percent">100%</div>
        <script src="script.js"></script>
        ```
        
        ã€Šç°ä»£jsã€‹ä¸­æåˆ°çš„`innerHTML+=` çš„ç†è§£ï¼š
        
        ```jsx
        // elem.innerHTML+='HelloWorld' ç­‰åŒäºğŸ‘‡
        elem.innerHTML = elem.innerHTML + 'HelloWorld';
        ```
        
        ä¸Šé¢çš„è¯­å¥ä¼šå®Œå…¨é‡å†™ï¼Œä¹Ÿå°±æ˜¯æ—§çš„HTMLåŠ ä¸Š'HelloWorld'ã€‚è¿™æ®µä»£ç å°±æ˜¯å°†æ—§çš„åŠ ä¸Šæ–°çš„çš„ä¹‹åå†è¦†ç›–æ‰åŸæ¥çš„ã€‚è¿™å°±æ˜¯é‡å†™äº†ï¼Œæ‰€ä»¥å¦‚æœHTMLä¸­éœ€è¦åŠ è½½èµ„æºçš„è¯åˆ™ä¼šé‡æ–°åŠ è½½èµ„æºã€‚
        
    2. **innerText**
       
        å¾—åˆ°çš„ç»“æœå’ŒtextContentçš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯å»é™¤æ‰€æœ‰çš„æ ‡ç­¾ã€‚
        
    3. **outerHTML**ï¼šåœ¨innerHTMLçš„åŸºç¡€ä¸ŠåŒ…æ‹¬è‡ªå·±æœ¬èº«çš„å…ƒç´ ã€‚
       
        document.body.outerHTMLä¸æ­¢åŒ…å«å…¶åä»£çš„HTMLè¿˜åŒ…æ‹¬ä»–bodyæœ¬èº«ã€‚
        
    4. **textContent**
       
        æä¾›äº†å¯¹**å…ƒç´ å†…çš„æ–‡æœ¬**çš„è®¿é—®æƒé™ï¼šä»…æ–‡æœ¬ï¼Œå»æ‰æ‰€æœ‰æ ‡ç­¾ã€‚
        
        è¿™ä¸ªå±æ€§ä¸€èˆ¬ä¸æ‹¿æ¥è¯»ï¼Œä½†æ˜¯å†™å…¥ä¼šç”¨å¾—æ¯”è¾ƒå¤šä¸€äº›ã€‚
        
        â—è¿™é‡Œåˆæ¶‰åŠåˆ°innerHTMLä¸textContentçš„åŒºåˆ«ï¼š
        
        - å†™å…¥textContentï¼Œæ˜¯ä»¥æ–‡æœ¬çš„å½¢å¼å†™å…¥çš„
        - å†™å…¥innerHTMLï¼Œå¦‚æœæ–‡æœ¬ä¸­æœ‰æ ‡ç­¾æ˜¯è¦è¢«æµè§ˆå™¨æ­£å¸¸æ¸²æŸ“ä¸ºç›¸åº”çš„æ ‡ç­¾çš„ã€‚
    5. **nodeValueã€ data**  åªå¯¹æ–‡æœ¬èŠ‚ç‚¹æœ‰æ•ˆ

## é—®é¢˜é›†

- ä¸ºä»€ä¹ˆä»¥ä¸‹ä»£ç ä½¿ç”¨calc( )å‡½æ•°è®¡ç®—ä¸èµ·ä½œç”¨ï¼Ÿ
  
    ```css
    width: calc(100vw + 60px); // æœ‰æ•ˆ  ä¸­é—´+å·ä¸¤ç«¯æœ‰ç©ºæ ¼
    height: calc(100vh+60px);  // æ— æ•ˆ
    ```
    
    åœ¨mdnçš„calcçš„å‚è€ƒä¸­æåˆ°ï¼š
    
    â€¢ **`+`Â å’ŒÂ `-`Â è¿ç®—ç¬¦çš„ä¸¤è¾¹å¿…é¡»è¦æœ‰ç©ºç™½å­—ç¬¦ã€‚**æ¯”å¦‚ï¼Œ`calc(50% -8px)`Â ä¼šè¢«è§£ææˆä¸ºä¸€ä¸ªæ— æ•ˆçš„è¡¨è¾¾å¼ï¼Œè§£æç»“æœæ˜¯ï¼šä¸€ä¸ªç™¾åˆ†æ¯” åè·Ÿä¸€ä¸ªè´Ÿæ•°é•¿åº¦å€¼ã€‚è€ŒåŠ æœ‰ç©ºç™½å­—ç¬¦çš„ã€æœ‰æ•ˆçš„è¡¨è¾¾å¼Â `calc(8px + -50%)`Â ä¼šè¢«è§£ææˆä¸ºï¼šä¸€ä¸ªé•¿åº¦ åè·Ÿä¸€ä¸ªåŠ å· å†è·Ÿä¸€ä¸ªè´Ÿç™¾åˆ†æ¯”ã€‚
    
- backgroundçš„ç®€å†™ä»£ç è§£æ
  
    ```css
    background: url('https://images.unsplash.com/photo-1576161787924-01bb08dad4a4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2104&q=80')
        no-repeat center center/cover; // å›¾ç‰‡ repeat     position/cover
    ```
    
- setIntervalçš„å‡½æ•°è°ƒç”¨
  
    ```css
    let timeId = setInterval(blurring, 30);  // è€Œä¸æ˜¯blurring()
    ```
    
    æ³¨æ„æ˜¯æ²¡æœ‰æ‹¬å·çš„ï¼Œå› ä¸ºsetIntervalæœŸæœ›å¾—åˆ°ä¸€ä¸ªå¯¹å‡½æ•°çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯blurring( )å‡½æ•°æ‰§è¡Œä¹‹åçš„ç»“æœã€‚
    

## é¡¹ç›®é‡ç‚¹/éš¾ç‚¹

èƒŒæ™¯æ¨¡ç³Šæ•ˆæœï¼Œç¬¬ä¸€æ¬¡å†™ã€‚

é¦–å…ˆæ‹†å¼€æ¥åˆ†æï¼Œâ€œé®ç½©å±‚â€ï¼š

ä¸€èˆ¬æƒ…å†µä¸‹æƒ³åˆ°ç”¨`filterï¼šblur(2px)`å±æ€§æ¥å¤„ç†ã€‚ä½†æ˜¯blurçš„å€¼è¶Šæ¥è¶Šå¤§ï¼Œå››å‘¨ä¼šå‡ºç°è¶Šæ¥è¶Šä¸¥é‡çš„ç™½è¾¹ç°è±¡ã€‚`filter: blur(30px)`çš„æ•ˆæœğŸ‘‡

![å›¾ä¸€](note-images/Untitled.png)

å›¾ä¸€

å¥½å§ï¼Œå‘ç°äº†ä¸å¾—äº†çš„ä¸œè¥¿å“ˆå“ˆå“ˆå“ˆï¼Œè¿™ä¸ªç™½è¾¹çš„é—®é¢˜æ˜¯ç”±äºbodyæ ¹çš„èƒŒæ™¯é¢œè‰²æ˜¯ç™½è‰²çš„ã€‚htmlå’Œbodyä¹‹é—´å¯èƒ½å­˜åœ¨ç€æŸç§å®‡å®™é—´éš™(æˆ‘çŒœçš„ï¼Œå…¶å®æˆ‘ä¸çŸ¥é“)ï¼Œåˆ°åº•ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ‰¾åˆ°ä¸€ç¯‡æ–‡ç« ï¼š[å»æ‰æ¨¡ç³ŠèƒŒæ™¯æˆ–å›¾ç‰‡çš„ç™½è¾¹](https://www.clloz.com/programming/front-end/css/2019/05/23/blur-white-border/)

ä¸Šé¢çš„æ–‡ç« ä¸­å†™åˆ°æ¨¡ç³Šæ•ˆæœä¼šè®©åº•å±‚çš„é¢œè‰²éœ²å‡ºæ¥ï¼Œé‚£å°±æ˜¯bodyçš„èƒŒæ™¯é»˜è®¤æ˜¯ç™½è‰²çš„ã€‚æˆ‘æŠŠbodyèƒŒæ™¯è‰²å˜æˆé»‘è‰²ä¹‹åçš„æ•ˆæœï¼šå¥½åƒå¥½å¤šäº†ã€‚

![å›¾äºŒ](note-images/Untitled%201.png)

å›¾äºŒ

bluræ–¹æ³•æ˜¯ä½¿ç”¨é«˜æ–¯æ¨¡ç³Šå¤„ç†å›¾åƒï¼Œä½¿ä¹‹å‡å°‘å™ªéŸ³å’Œç»†èŠ‚ï¼Œè¾¾åˆ°å¹³æ»‘æ¨¡ç³Šæ•ˆæœã€‚

å…³äºå¤„ç†æ¨¡ç³ŠèƒŒæ™¯çš„ç™½è¾¹é—®é¢˜ï¼Œè¿™ä¸ªé¡¹ç›®çš„åŸä½œè€…é‡‡ç”¨çš„æ˜¯æ‰©å¤§èƒŒæ™¯æ‰€åœ¨å…ƒç´ çš„å¤§å°ï¼Œä»¥åŠæŠŠæ¨¡ç³Šéƒ¨åˆ†ç§»åŠ¨åˆ°å¯è§†èŒƒå›´ä¹‹å¤–ã€‚

```css
position: absolute; // ä½¿ç”¨ç»å¯¹å®šä½æŠŠç™½è¾¹å¯¹åº”çš„èƒŒæ™¯å¯è§†éƒ¨åˆ†å¤–ç§»
top: -30px;
left: -30px;
width: calc(100vw + 60px );  // æ‰©å¤§èƒŒæ™¯æ‰€åœ¨çš„å…ƒç´ å¤§å°
height: calc(100vh + 60px );
```

![](C:\Users\seaEliy\Documents\MyDocument\æ–‡æ¡£\æ¹¾å¤§äºŒæ‰‹\image\image-20220215183420620.png)

åŸé¡¹ç›®ä½œè€…çš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°è¿˜æ˜¯æœ‰ä¸€ç‚¹ç‚¹ç™½è¾¹çš„ã€‚å¥½å§ï¼Œä¸çŸ¥é“è¿™é‡Œä¸ºä»€ä¹ˆæ˜¾ç¤ºä¸å‡ºæ¥ç™½è¾¹....

æˆ‘çš„æ–¹æ³•å°±æ˜¯æŠŠèƒŒæ™¯å›¾æ‰€åœ¨å…ƒç´ çš„çˆ¶å…ƒç´ çš„èƒŒæ™¯è‰²ï¼Œè®¾ç½®ä¸ºæ¯”ä½ æƒ³è¦çš„æ¨¡ç³Šæ•ˆæœæ›´æ·±ä¸€äº›çš„é¢œè‰²ã€‚å°±æ˜¯å›¾äºŒä¸­çš„æ•ˆæœã€‚

## Demoæœ€éš¾ç‚¹

èƒŒæ™¯ä»æ¨¡ç³Šåˆ°é€æ˜çš„åŒæ—¶æ˜¾ç¤ºç™¾åˆ†æ¯”100%-0%çš„åŠ è½½ï¼ˆä¸é€æ˜åˆ°é€æ˜ï¼‰ã€‚

![https://media.giphy.com/media/DvXvTTloMHYjJ3GZIn/giphy.gif](https://media.giphy.com/media/DvXvTTloMHYjJ3GZIn/giphy.gif)

æºç ï¼š

```jsx
let bg = document.querySelector('.bg');
let percent = document.querySelector('.percent');

let load = 0;

let timeId = setInterval(blurring, 30);

function blurring() {
    load++;

    if (load > 99) {
        clearInterval(timeId);
    }

    percent.innerText = `${load}%`;
    percent.style.opacity = scale(load, 0, 100, 1, 0);   // 1-0
    bg.style.filter = `blur(${scale(load, 0, 100, 30, 0)}px)`; // 30-0
}

// æ­¤å‡½æ•°æ ¹æ®loadï¼ˆ0-100çš„å€¼ï¼‰åˆ†åˆ«æ˜¾ç¤º1-0å’Œ30-0ï¼ˆä¿ç•™å°æ•°ç‚¹åä¸¤ä½çº§åˆ«ï¼‰çš„å€¼ã€‚
const scale = (load, in_min, in_max, out_min, out_max) => {
    return ((load - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min
}
```

å¯è§

- `opacity` çš„å€¼1-0çš„è¿‡ç¨‹æ˜¯0.99ã€0.98ã€0.97çš„ä¸¤ä½å°æ•°çš„ç²¾ç¡®åº¦å˜åŒ–
- `blur()` çš„å€¼30-0çš„è¿‡ç¨‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

scaleå‡½æ•°å¯¼è‡´äº†è¿™ç§ç²¾ç¡®åŒ–çš„å˜åŒ–ï¼Œè¿™ä¸ªå‡½æ•°å¾ˆå·§å¦™ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œå…¶æ¨¡ç³Šæ•ˆæœå˜åŒ–æ˜¯å¾ˆå¿«çš„ï¼Œåˆšå¼€å§‹æˆ‘è‡ªå·±å†™çš„æ—¶å€™æ˜¯é‡‡ç”¨100è‡ªå‡çš„è¿‡ç¨‹ï¼Œæ²¡æœ‰è¿™ä¹ˆç²¾ç¡®ï¼Œæ‰€ä»¥æ˜¯å¾ˆå¿«çš„ã€‚å¦‚æœè¿™ä¸ªå‡½æ•°æ²¡ææ˜ç™½ï¼Œä¹Ÿå¯ä»¥å«å¦ä¸€ç§å®ç°æ–¹å¼å°±è¡Œäº†ï¼Œæ¯”å¦‚å®šä¹‰ä¸¤ä¸ªè®¡æ•°çš„å˜é‡ã€‚è¿™é‡Œä¸å…·ä½“å®ç°äº†ã€‚

## æ€»ç»“

- å…ˆè‡ªå·±å†™ä¸€é
- å®åœ¨å†™ä¸å‡ºæ¥ï¼Œè‡ªå·±Googleä¸€ä¸‹
- è¿˜å†™ä¸å‡ºæ¥ç›´æ¥çœ‹æºç ï¼Œçœ‹æ‡‚ä¸ºä»€ä¹ˆè¿™æ ·é‚£æ ·ã€‚è¦åˆ‡å®çœ‹æ‡‚ã€‚
- çœ‹ä¸æ‡‚ï¼Œå†æŸ¥å†åˆ†æã€‚

ä»¥ä¸Šè¿‡ç¨‹ä¸­å°è¯•æŠŠè‡ªå·±é‡åˆ°çš„é—®é¢˜ï¼Œéš¾ç‚¹ï¼ŒæƒŠè‰³çš„åœ°æ–¹è®°å½•ä¸‹æ¥ã€‚æ•´ä¸ªè¿‡ç¨‹è™½ç„¶æ¯”è¾ƒè€—è´¹æ—¶é—´ï¼Œä½†æ˜¯æ•ˆæœçœŸçš„å¾ˆä¸é”™ã€‚